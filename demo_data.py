from datetime import datetime

# –°–ø–∏—Å–æ–∫ —Å–º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –æ–±–º–µ–Ω–æ–≤ —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –¥–∞—Ç–∞–º–∏
exchanges = [
    {
        "date": "10.03.2025 14:30",
        "from_user": ("–ê–ª–∏—Ö–∞–Ω –ö–∞–ª—ã–±–µ–∫–æ–≤", "khandrok", "–ì–æ—Å—É–¥–∞—Ä—å, –ü—Ä–µ—Å—Ç—É–ø–ª–µ–Ω–∏–µ –∏ –Ω–∞–∫–∞–∑–∞–Ω–∏–µ, –ë–µ–ª—ã–µ –Ω–æ—á–∏"),
        "to_user": ("–°–∞–∏–¥–∞", "LAGMAAAAN", "–ú–∞–ª–µ–Ω—å–∫–∏–µ –∂–µ–Ω—â–∏–Ω—ã –Ω–∞ –∞–Ω–≥–ª, –°—Ç–∏–≤–µ–Ω –ö–∏–Ω–≥ - –¥–æ–∫—Ç–æ—Ä —Å–æ–Ω, –°—Ç–∏–≥–º–∞–ª–∏–æ–Ω - –ö—Ä–∏—Å—Ç–∏–Ω–∞ —Å—Ç–∞—Ä–∫"),
        "book_given": "–ü—Ä–µ—Å—Ç—É–ø–ª–µ–Ω–∏–µ –∏ –Ω–∞–∫–∞–∑–∞–Ω–∏–µ",
        "book_received": "–°—Ç–∏–≤–µ–Ω –ö–∏–Ω–≥ - –¥–æ–∫—Ç–æ—Ä —Å–æ–Ω",
        "status": "‚úÖ –£—Å–ø–µ—à–Ω–æ"
    },
    {
        "date": "12.03.2025 10:15",
        "from_user": ("–î–∏–∞—Å", "ClayzDart", "–ú–∞—Ç—å –£—á–µ–Ω—å—è, –ü–æ–≤–µ–ª–∏—Ç–µ–ª—å –¢–∞–π–Ω"),
        "to_user": ("–ê–π–≥–µ—Ä–∏–º", "microkosmoos", ""),
        "book_given": "–ü–æ–≤–µ–ª–∏—Ç–µ–ª—å –¢–∞–π–Ω",
        "book_received": "–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–Ω–∏–≥–∏",
        "status": "‚úÖ –£—Å–ø–µ—à–Ω–æ"
    },
    {
        "date": "12.03.2025 18:45",
        "from_user": ("–ì–ª–µ–± –î–º–∏—Ç—Ä–∏–µ–≤", "glebdmitriyev", "1.000.000$ –≤ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏—è—Ö –Ω–∞ –ø–∞–ª—å—Ü–∞—Ö, –û —á–µ–º —è –≥–æ–≤–æ—Ä—é, –∫–æ–≥–¥–∞ –≥–æ–≤–æ—Ä—é –æ –±–µ–≥–µ, –ö–µ–º–µ–ª –ê–¥–∞–º, –ù–∞–µ–¥–∏–Ω–µ —Å —Å–æ–±–æ–π, –í–µ–ª–∏–∫–∏–π –ì—ç—Ç—Å–±–∏"),
        "to_user": ("–ê—Ä—Ç–µ–º–∏–π", "werexx", "–ß–∞—Å–æ–¥–µ–∏ - –≤—Å–µ —á–∞—Å—Ç–∏"),
        "book_given": "–í–µ–ª–∏–∫–∏–π –ì—ç—Ç—Å–±–∏",
        "book_received": "–ß–∞—Å–æ–¥–µ–∏ - –≤—Å–µ —á–∞—Å—Ç–∏",
        "status": "‚úÖ –£—Å–ø–µ—à–Ω–æ"
    },
    {
        "date": "18.03.2025 11:20",
        "from_user": ("–ù–∞–≥–∏", "killstationexxidae", "–¢–µ–º–Ω–∞—è –±–∞—à–Ω—è, –¥–µ–∑–µ—Ä—Ç–∏—Ä, —É—Ç—Ä–∞—á–µ–Ω–Ω—ã–µ –∏–ª–ª—é–∑–∏–∏, –≤–∞–Ω–ø–∞–Ω—á–º–µ–Ω"),
        "to_user": ("–ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏–Ω", "Konstanteeeen", "–û–º–∞—Ä –•–∞–π—è–º"),
        "book_given": "–¢–µ–º–Ω–∞—è –±–∞—à–Ω—è",
        "book_received": "–û–º–∞—Ä –•–∞–π—è–º",
        "status": "‚úÖ –£—Å–ø–µ—à–Ω–æ"
    },
    {
        "date": "20.03.2025 16:10",
        "from_user": ("–ê—Ö–º–µ—Ç–æ–≤–∞ –ê—Å—ã–ª—ã–º", "asikoakhmetova", "–•–æ—á—É –∏ –±—É–¥—É - –ú.–õ–∞–±–∫–æ–≤—Å–∫–∏–π"),
        "to_user": ("–∞–º–∏–Ω–∞", "amillienn", "–¥–Ω–µ–≤–Ω–∏–∫ –ø–∞–º—è—Ç–∏"),
        "book_given": "–•–æ—á—É –∏ –±—É–¥—É - –ú.–õ–∞–±–∫–æ–≤—Å–∫–∏–π",
        "book_received": "–¥–Ω–µ–≤–Ω–∏–∫ –ø–∞–º—è—Ç–∏",
        "status": "‚úÖ –£—Å–ø–µ—à–Ω–æ"
    },
    {
        "date": "22.03.2025 09:30",
        "from_user": ("–î—É–ª–∞—Ç", "dulbl4", "48 –∑–∞–∫–æ–Ω–æ–≤ –≤–ª–∞—Å—Ç–∏, –ú–µ—Ç—Ä–æ 2033, –í–æ–π–Ω–∞ –∏ –º–∏—Ä 4 —Ç–æ–º–∞"),
        "to_user": ("Tsoi", "thch0l", "–î–µ—Ç—Å—Ç–≤–æ, –Æ–Ω–æ—Å—Ç—å –æ—Ç—Ä–æ—á–µ—Å—Ç–≤–æ - —Ç–æ–ª—Å—Ç–æ–π, –ë–µ–¥–Ω—ã–µ –ª—é–¥–∏ - –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π"),
        "book_given": "48 –∑–∞–∫–æ–Ω–æ–≤ –≤–ª–∞—Å—Ç–∏",
        "book_received": "–ë–µ–¥–Ω—ã–µ –ª—é–¥–∏ - –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π",
        "status": "‚úÖ –£—Å–ø–µ—à–Ω–æ"
    },
    {
        "date": "25.03.2025 13:45",
        "from_user": ("–ê—è–Ω–∞", "AyankaD", "–î–≤–æ–π–Ω–∏–∫ —Å –ª—É–Ω–Ω–æ–π –¥–∞–º–±—ã - —Å–æ–¥–∑–∏ —Å–∏–º–∞–¥–∞"),
        "to_user": ("–ù—É—Ä–∞–π –ï—Ä–∫–∏–Ω–±–µ–∫", "extrareader", "–§—Ä–∞–Ω—Ü –ö–∞—Ñ–∫–∞ ¬´–ü—Ä–æ—Ü–µ—Å—Å¬ª"),
        "book_given": "–î–≤–æ–π–Ω–∏–∫ —Å –ª—É–Ω–Ω–æ–π –¥–∞–º–±—ã",
        "book_received": "–§—Ä–∞–Ω—Ü –ö–∞—Ñ–∫–∞ ¬´–ü—Ä–æ—Ü–µ—Å—Å¬ª",
        "status": "‚úÖ –£—Å–ø–µ—à–Ω–æ"
    },
    {
        "date": "28.03.2025 17:00",
        "from_user": ("–†–æ–º–∞–Ω–∞—Å", "lanenotpunk", "–ì–∞—Ä—Ä–∏ –ü–æ—Ç—Ç–µ—Ä –∏ –§–∏–ª–æ—Å–æ—Ñ—Å–∫–∏–π –∫–∞–º–µ–Ω—å"),
        "to_user": ("–ú—É—Ö—Ç–∞—Ä–∫—ã–∑—ã –ú–∞—Ä–∏—è–º", "hamster_1303", ""),
        "book_given": "–ì–∞—Ä—Ä–∏ –ü–æ—Ç—Ç–µ—Ä –∏ –§–∏–ª–æ—Å–æ—Ñ—Å–∫–∏–π –∫–∞–º–µ–Ω—å",
        "book_received": "–ö–Ω–∏–≥–∏ –ø–æ –∑–∞–ø—Ä–æ—Å—É",
        "status": "‚úÖ –£—Å–ø–µ—à–Ω–æ"
    },
    {
        "date": "30.03.2025 12:25",
        "from_user": ("–ò–º–∞–Ω–±–µ—Ä–¥—ñ –ö”©—Ä–∫–µ–º", "Y_u_zuha", "–°–ø–µ—à–∏–π –ª—é–±–∏—Ç—å - –ù–∏–∫–æ–ª–æ—Å –°–ø–∞—Ä–∫—Å"),
        "to_user": ("–ê–ª—É–∞", "amankeldi_a", ""),
        "book_given": "–°–ø–µ—à–∏–π –ª—é–±–∏—Ç—å - –ù–∏–∫–æ–ª–æ—Å –°–ø–∞—Ä–∫—Å",
        "book_received": "–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –±–æ—Ç–∞",
        "status": "‚úÖ –£—Å–ø–µ—à–Ω–æ"
    },
    {
        "date": "01.04.2025 15:40",
        "from_user": ("–ê–π—Å–µ—Ä", "aaaiserr", ""),
        "to_user": ("–ì—É–º–∞–µ–≤–∞ –í–∏–æ–ª–µ—Ç—Ç–∞", "justacloudygirl", ""),
        "book_given": "–õ–∏—á–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏",
        "book_received": "–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞",
        "status": "‚úÖ –£—Å–ø–µ—à–Ω–æ"
    },
    {
        "date": "01.04.2025 10:50",
        "from_user": ("–°–º–∞–≥—É–ª–æ–≤–∞ –ê–¥–µ–ª–∏—è", "Bilimqyzy", ""),
        "to_user": ("–ï–¥—ñ–ª“±–ª—ã –ê—Å—ã–ª–∂–∞–Ω", "None", ""),
        "book_given": "–ù–∞—É—á–Ω—ã–µ –∫–Ω–∏–≥–∏",
        "book_received": "–î–µ–ª–æ–≤–∞—è –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞",
        "status": "‚úÖ –£—Å–ø–µ—à–Ω–æ"
    },
    {
        "date": "04.04.2025 19:15",
        "from_user": ("–ö–∞–±–¥—ã–π –ê–π—ã–º", "Aimkhgvd", ""),
        "to_user": ("–õ–∏–º –¢–∞—Ç—å—è–Ω–∞", "lim_tn", ""),
        "book_given": "–ö–Ω–∏–≥–∏ –ø–æ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏—è–º",
        "book_received": "–•—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞",
        "status": "‚úÖ –£—Å–ø–µ—à–Ω–æ"
    }
]

# –°–æ—Ä—Ç–∏—Ä—É–µ–º –æ–±–º–µ–Ω—ã –ø–æ –¥–∞—Ç–µ
exchanges.sort(key=lambda x: datetime.strptime(x['date'], "%d.%m.%Y %H:%M"))

# –í—ã–≤–æ–¥ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –æ–±–º–µ–Ω–∞—Ö
print("üìö –û–ë–ú–ï–ù–´ –ö–ù–ò–ì–ê–ú–ò \n")
print(f"üìÖ –ü–µ—Ä–∏–æ–¥: 10.03.2025 - 04.04.2025")
print("="*60)
for i, exchange in enumerate(exchanges, 1):
    print(f"\nüîÑ –û–±–º–µ–Ω #{i}")
    print(f"üìÖ –î–∞—Ç–∞: {exchange['date']}")
    print(f"üë§ –û—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å: {exchange['from_user'][0]} (@{exchange['from_user'][1]})")
    print(f"   üìñ –ö–Ω–∏–≥–∏: {exchange['from_user'][2]}")
    print(f"üë§ –ü–æ–ª—É—á–∞—Ç–µ–ª—å: {exchange['to_user'][0]} (@{exchange['to_user'][1]})")
    print(f"   üìñ –ö–Ω–∏–≥–∏: {exchange['to_user'][2]}")
    print(f"üì§ –û—Ç–¥–∞–ª: {exchange['book_given']}")
    print(f"üì• –ü–æ–ª—É—á–∏–ª: {exchange['book_received']}")
    print(f"üü¢ –°—Ç–∞—Ç—É—Å: {exchange['status']}")
    print("="*60)

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
print("\nüìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê –û–ë–ú–ï–ù–û–í")
print("="*60)
total_exchanges = len(exchanges)
unique_users = len(set([ex['from_user'][1] for ex in exchanges] + [ex['to_user'][1] for ex in exchanges]))
print(f"‚Ä¢ –í—Å–µ–≥–æ –æ–±–º–µ–Ω–æ–≤: {total_exchanges}")
print(f"‚Ä¢ –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤: {unique_users}")

# –ü–æ–¥—Å—á–µ—Ç –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∫–Ω–∏–≥
book_counts = {}
for ex in exchanges:
    book_counts[ex['book_given']] = book_counts.get(ex['book_given'], 0) + 1
    book_counts[ex['book_received']] = book_counts.get(ex['book_received'], 0) + 1

top_books = sorted(book_counts.items(), key=lambda x: x[1], reverse=True)[:3]
print("\nüèÜ –¢–æ–ø-3 –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∫–Ω–∏–≥–∏:")
for book, count in top_books:
    print(f"‚Ä¢ {book}: {count} –æ–±–º–µ–Ω–æ–≤")

print("="*60)

# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ: —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –Ω–µ–¥–µ–ª—è–º
print("\nüìÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –Ω–µ–¥–µ–ª—è–º:")
weeks = {}
for ex in exchanges:
    date = datetime.strptime(ex['date'], "%d.%m.%Y %H:%M")
    week_num = date.isocalendar()[1]
    weeks[week_num] = weeks.get(week_num, 0) + 1

for week, count in sorted(weeks.items()):
    print(f"‚Ä¢ –ù–µ–¥–µ–ª—è {week}: {count} –æ–±–º–µ–Ω–æ–≤")

print("="*60)